(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cd06c7e"],{"45f5":function(t,e,n){},"663f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"g",(function(){return h})),n.d(e,"f",(function(){return p})),n.d(e,"i",(function(){return f})),n.d(e,"h",(function(){return y})),n.d(e,"e",(function(){return g})),n.d(e,"d",(function(){return _})),n.d(e,"c",(function(){return v})),n.d(e,"b",(function(){return w})),Date.prototype.format=function(){var t="",e=this.getMonth()+1>=10?this.getMonth()+1:"0"+(this.getMonth()+1),n=this.getDate()>=10?this.getDate():"0"+this.getDate();return t+=this.getFullYear()+"-",t+=e+"-",t+=n,t};var i=function(t,e){var n=[],i=t.split("-"),a=e.split("-"),s=new Date;s.setUTCFullYear(i[0],i[1]-1,i[2]);var r=new Date;r.setUTCFullYear(a[0],a[1]-1,a[2]);for(var o=s.getTime()-864e5,c=r.getTime()-864e5,l=o;l<=c;)l+=864e5,n.push(new Date(parseInt(l)).format());return n},a=new Date,s=a.getDay(),r=a.getDate(),o=a.getMonth(),c=a.getYear();c+=c<2e3?1900:0;var l=new Date;l.setDate(1),l.setMonth(l.getMonth()-1);l.getYear();var u=l.getMonth();function d(t){var e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return n<10&&(n="0"+n),i<10&&(i="0"+i),e+"-"+n+"-"+i}function m(t){var e=new Date(c,t,1),n=new Date(c,t+1,1),i=(n-e)/864e5;return i}function h(){var t=new Date(c,o,r-s+1-7);return d(t)}function p(){var t=new Date(c,o,r+(6-s)+1-7);return d(t)}function f(){var t=new Date(c,o,r-s+1);return d(t)}function y(){var t=new Date(c,o,r+(6-s)+1);return d(t)}function g(){var t=new Date(c,o,1);return d(t)}function _(){var t=new Date(c,o,m(o));return d(t)}function v(){var t=new Date(c,u,1);return d(t)}function w(){var t=new Date(c,u,m(u));return d(t)}},c1ec:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{attrs:{title:"日总结"}},[n("Tabs",{attrs:{value:"my",animated:!1}},[n("TabPane",{attrs:{label:"我的总结",name:"my"}},[n("div",{staticStyle:{"margin-bottom":"20px"}},[n("DatePicker",{attrs:{format:"yyyy年MM月",type:"month",placeholder:"工作总结时间"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),n("Checkbox",{staticStyle:{"margin-left":"10px"},model:{value:t.bhsy,callback:function(e){t.bhsy=e},expression:"bhsy"}},[t._v("含上月数据")]),n("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.initList}},[t._v("查询")]),n("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.addTemplate}},[t._v("新增")])],1),n("Table",{staticStyle:{"margin-bottom":"20px"},attrs:{border:"",columns:t.columns,data:t.list},on:{"on-selection-change":t.selectionChange},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[n("strong",[t._v(t._s(i._id.documentName))]),i._id.status_info.length>0?["0"==i._id.status_info[0].status?n("Tag",{attrs:{color:"red"}},[t._v("已退回")]):t._e(),"1"==i._id.status_info[0].status?n("Tag",{attrs:{color:"green"}},[t._v("已修正")]):t._e()]:t._e()]}},{key:"time",fn:function(e){var i=e.row;return[n("strong",[t._v(t._s(i.details[0].year+"-"+i.details[0].month+"-"+i.details[0].day))])]}},{key:"action",fn:function(e){var i=e.row,a=e.index;return[n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.show(i._id.documentId)}}},[t._v("查看")]),n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",disabled:i.details[0].status,size:"small"},on:{click:function(e){return t.edit(i._id.documentId)}}},[t._v("修改")]),n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",disabled:i.details[0].status,size:"small"},on:{click:function(e){return t.del(a,i._id.documentId)}}},[t._v("删除")]),n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"warning",disabled:i.details[0].status,size:"small"},on:{click:function(e){return t.getTodayTime(a,i._id.documentId,!0)}}},[t._v("上报")])]}}])}),n("Button",{attrs:{type:"primary"},on:{click:t.merge}},[t._v("合并查看")]),n("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:t.setWeek}},[t._v("合并生成周总结")])],1),n("TabPane",{attrs:{label:"部门总结",name:"part"}},[n("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[n("Col",{attrs:{span:"16"}},[n("Date-picker",{staticClass:"margin-bottom20",staticStyle:{width:"100%"},attrs:{value:t.showdate,type:"daterange",confirm:"",placeholder:"选择日期"},on:{"on-change":t.handelChange}})],1),n("Col",{attrs:{span:"8"}},[n("Button",{staticClass:"margin-bottom20",attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("yestday")}}},[t._v("昨天")]),n("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("day")}}},[t._v("今天")]),n("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("week")}}},[t._v("本周")]),n("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("month")}}},[t._v("本月")]),n("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("preMonth")}}},[t._v("上月")])],1)],1),n("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[n("Col",{attrs:{span:"16"}},[n("Select",{staticClass:"margin-bottom20",attrs:{clearable:"",multiple:"",placeholder:"选择员工"},model:{value:t.people,callback:function(e){t.people=e},expression:"people"}},t._l(t.peopleList,(function(e){return n("Option",{key:e.userId,attrs:{value:e.userId}},[t._v(t._s(e.nickName?e.nickName:e.userName))])})),1)],1),n("Col",{attrs:{span:"8"}},[n("Button",{staticClass:"margin-bottom20",attrs:{type:"primary",ghost:""},on:{click:function(e){t.people=[]}}},[t._v("清空选择")]),n("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:t.peopleAll}},[t._v("选择全部")])],1)],1),n("Button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary"},on:{click:t.seach}},[t._v("查询")]),n("Table",{staticStyle:{"margin-bottom":"20px"},attrs:{border:"",columns:t.columnPart,data:t.listPart},on:{"on-selection-change":t.selectionChangePart},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[n("strong",[t._v(t._s(i._id.documentName))]),i._id.status_info.length>0?["0"==i._id.status_info[0].status?n("Tag",{attrs:{color:"red"}},[t._v("已退回")]):t._e(),"1"==i._id.status_info[0].status?n("Tag",{attrs:{color:"green"}},[t._v("已修正")]):t._e()]:t._e()]}},{key:"time",fn:function(e){var i=e.row;return[n("strong",[t._v(t._s(i.details[0].year+"-"+i.details[0].month+"-"+i.details[0].day))])]}},{key:"people",fn:function(e){var i=e.row;return[n("strong",[t._v(t._s(i.details[0].nickName))])]}},{key:"action",fn:function(e){var i=e.row,a=e.index;return[n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.adminshow(i._id.documentId)}}},[t._v("查看")]),1===t.type?n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"warning",disabled:!i.details[0].status,size:"small"},on:{click:function(e){return t.commit(a,i._id.documentId,!1)}}},[t._v("退回")]):t._e()]}}])}),n("Button",{attrs:{type:"primary"},on:{click:t.mergePart}},[t._v("合并查看")])],1)],1),n("Modal",{attrs:{title:"合并生成周总结"},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[n("Input",{attrs:{type:"text",placeholder:"请输出周总结名称"},model:{value:t.weekTitle,callback:function(e){t.weekTitle=e},expression:"weekTitle"}}),n("template",{slot:"footer"},[n("Button",{on:{click:function(e){t.modal=!1}}},[t._v("取消")]),n("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.mergeWeek}},[t._v("确定")])],1)],2)],1)},a=[],s=n("365c"),r=n("663f"),o=n("caaf"),c=n.n(o);function l(t){return h(t)||m(t)||d(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){if(t){if("string"===typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function m(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function h(t){if(Array.isArray(t))return p(t)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y={data:function(){var t;return t={bhsy:!1,list:[],listPart:[],showdate:[],type:0,weekTitle:"设计部2020年05月25日-29日工作总结（姓名）",startTime:"",endTime:"",modal:!1,selectionList:[],selectionListPart:[],time:new Date,peopleList:[],people:[],columns:[{type:"index",width:60,align:"center"},{type:"selection",width:60,align:"center"},{title:"名称",slot:"name"},{title:"日期",width:120,align:"center",slot:"time"},{title:"操作",slot:"action",width:220,align:"center"}]},f(t,"columns",[{type:"index",width:60,align:"center"},{type:"selection",width:60,align:"center"},{title:"名称",slot:"name"},{title:"日期",width:120,align:"center",slot:"time"},{title:"操作",slot:"action",width:260,align:"center"}]),f(t,"columnPart",[{type:"index",width:60,align:"center"},{type:"selection",width:60,align:"center"},{title:"名称",slot:"name"},{title:"时间",width:120,align:"center",slot:"time"},{title:"人员",width:100,align:"center",slot:"people"},{title:"操作",slot:"action",width:160,align:"center"}]),t},methods:{getTodayTime:function(t,e,n){var i=this;return Object(s["wb"])({userId:JSON.parse(localStorage.getItem("userInfo")).userId,date:this.list[t].details[0].year+"-"+this.list[t].details[0].month+"-"+this.list[t].details[0].day}).then((function(a){0!=a.data?i.commit(t,e,n):i.$Message.error("本日工时未添加，请添加后上报")}))},setWeek:function(){this.modal=!0;var t=_.sortBy(this.selectionList,(function(t){return new Date(t._id.year+"-"+t._id.month+"-"+t._id.day).getTime()}));this.weekTitle="设计部".concat(t[0]._id.year,"年").concat(t[0]._id.month,"月").concat(t[0]._id.day,"日-").concat(t[t.length-1]._id.month,"月").concat(t[t.length-1]._id.day,"日工作总结（").concat(JSON.parse(localStorage.getItem("userInfo")).nickName,"）")},handelChange:function(t){this.startTime=t[0],this.endTime=t[1]},selectionChange:function(t){this.selectionList=t},selectionChangePart:function(t){this.selectionListPart=t},peopleAll:function(){this.people=[];for(var t=0;t<this.peopleList.length;t++){var e=this.peopleList[t];this.people.push(e.userId)}},commit:function(t,e,n){var i=this,a=n?"上报之后不可修改和删除，是否要上报？":"确定要退回吗？";this.confirm(a,(function(){Object(s["l"])({documentId:e,status:n}).then((function(e){1==e.code&&(n?(i.$set(i.list[t].details[0],"status",n),i.$Message.success("上报成功")):(i.$set(i.listPart[t].details[0],"status",n),i.$Message.success("退回成功")))}))}))},quickTime:function(t){"yestday"==t?(this.startTime=c()().add(-1,"days").format("YYYY-MM-DD"),this.endTime=c()().add(-1,"days").format("YYYY-MM-DD"),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):"day"==t?(this.startTime=c()().format("YYYY-MM-DD"),this.endTime=c()().format("YYYY-MM-DD"),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):"week"==t?(this.startTime=Object(r["i"])(),this.endTime=Object(r["h"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):"month"==t?(this.startTime=Object(r["e"])(),this.endTime=Object(r["d"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):(this.startTime=Object(r["c"])(),this.endTime=Object(r["b"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime))},getUserList:function(){var t=this;Object(s["H"])().then((function(e){1===e.code&&(t.peopleList=e.data,t.peopleAll())}))},merge:function(){var t=[],e=[];if(0!=this.selectionList.length){for(var n=0;n<this.selectionList.length;n++)t.push(this.selectionList[n]._id.documentId),e.push(this.selectionList[n].details[0].day);this.$router.push({name:"summary-merge",query:{mergeList:t,type:"day",month:c()(this.time).format("MM"),day:e}})}else this.$Message.error("请选择要合并的总结")},mergePart:function(){var t=[];if(0!=this.selectionListPart.length)if(this.selectionListPart.length<2)this.$Message.error("请至少选择2行内容进行合并查看");else{for(var e=0;e<this.selectionListPart.length;e++)t.push(this.selectionListPart[e]._id.documentId);var n=this.$router.resolve({name:"summary-merge",query:{mergeList:t,type:"day",admin:!0}});window.open(n.href,"_blank")}else this.$Message.error("请选择要合并的总结")},download:function(t){window.location.href="http://"+window.location.hostname+":3333/download/markdown?fileName="+t},initList:function(){var t=this;Object(s["X"])("day",{userId:JSON.parse(localStorage.getItem("userInfo")).userId,year:c()(this.time).format("YYYY"),month:c()(this.time).format("MM"),premonth:this.bhsy?c()(this.time).add(-1,"month").format("MM"):""}).then((function(e){if(1==e.code){var n=_.sortBy(e.prelist,(function(t){return parseInt(t._id.day)}));t.list=_.sortBy(e.data,(function(t){return parseInt(t._id.day)})),t.list=[].concat(l(n),l(t.list)).reverse(),t.$Message.success("查询成功")}}))},seach:function(){var t=this,e={startTime:this.startTime,endTime:this.endTime,people:this.people,system:this.system};""!=this.startTime&&""!=this.endTime&&0!=this.people.length?Object(s["pb"])(e).then((function(e){t.listPart=e.data.filter((function(t){return t._id.status_info.length>0||t.details[0].status})),t.$Message.success("查询成功")})):this.$Message.info("查询条件必填")},adminshow:function(t){var e=this.$router.resolve({name:"summary-admindetails",query:{id:t,type:"day"}});window.open(e.href,"_blank")},show:function(t){var e=this.$router.resolve({name:"summary-details",query:{id:t,type:"day"}});window.open(e.href,"_blank")},edit:function(t){this.$router.push({name:"summary-edit",query:{id:t,type:"day"}})},del:function(t,e){var n=this;this.confirm("确定要删除？",(function(){Object(s["u"])("day",{documentId:e}).then((function(e){1==e.code&&(n.list.splice(t,1),n.$Message.success("删除成功"))}))}))},confirm:function(t,e){this.$Modal.confirm({title:"提示",content:t,onOk:function(){e()}})},mergeWeek:function(){var t=this,e=[],n=_.sortBy(this.selectionList,(function(t){return e.push(t._id.documentId),new Date(t._id.year+"-"+t._id.month+"-"+t._id.day).getTime()})),i={documentName:this.weekTitle,userId:JSON.parse(localStorage.getItem("userInfo")).userId,userName:JSON.parse(localStorage.getItem("userInfo")).userName,nickName:JSON.parse(localStorage.getItem("userInfo")).nickName,year:"".concat(n[0]._id.year),startDay:"".concat(n[0]._id.year,"-").concat(n[0]._id.month,"-").concat(n[0]._id.day),endDay:"".concat(n[n.length-1]._id.year,"-").concat(n[n.length-1]._id.month,"-").concat(n[n.length-1]._id.day),list:e};Object(s["vb"])(i).then((function(e){1===e.code&&(t.modal=!1,t.$Message.success("生成成功，请至周总结中查看"))}))},addTemplate:function(){this.$router.push({name:"summary-edit",query:{id:"",type:"day"}})}},mounted:function(){this.initList(),this.getUserList(),this.type=JSON.parse(localStorage.getItem("userInfo")).type,0===this.type&&(this.columnPart[this.columnPart.length-1].width=100)}},g=y,v=(n("de30"),n("cba8")),w=Object(v["a"])(g,i,a,!1,null,"63d5daa6",null);e["default"]=w.exports},de30:function(t,e,n){"use strict";n("45f5")}}]);