(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e25b80b"],{"05f0":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Card",[s("Row",{attrs:{gutter:20}},[s("Col",{attrs:{span:"16"}},[s("Date-picker",{staticClass:"margin-bottom20",staticStyle:{width:"100%"},attrs:{value:t.showdate,type:"daterange",confirm:"",placeholder:"选择日期"},on:{"on-change":t.handelChange}})],1),s("Col",{attrs:{span:"8"}},[s("Button",{staticClass:"margin-bottom20",attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("week")}}},[t._v("本周")]),s("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("month")}}},[t._v("本月")]),s("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.quickTime("preMonth")}}},[t._v("上月")])],1)],1),s("Row",{attrs:{gutter:20}},[s("Col",{attrs:{span:"16"}},[s("Select",{staticClass:"margin-bottom20",attrs:{clearable:"",multiple:"",placeholder:"选择员工"},model:{value:t.people,callback:function(e){t.people=e},expression:"people"}},t._l(t.peopleList,function(e){return s("Option",{key:e.userId,attrs:{value:e.userId}},[t._v(t._s(e.nickName))])}),1)],1),s("Col",{attrs:{span:"8"}},[s("Button",{staticClass:"margin-bottom20",attrs:{type:"primary",ghost:""},on:{click:function(e){t.people=[]}}},[t._v("清空选择")]),s("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:t.peopleAll}},[t._v("选择全部")])],1)],1),s("Row",{attrs:{gutter:20}},[s("Col",{attrs:{span:"16"}},[s("Select",{staticClass:"margin-bottom20",attrs:{clearable:"",multiple:"",placeholder:"选择系统"},model:{value:t.system,callback:function(e){t.system=e},expression:"system"}},t._l(t.systemList,function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.title))])}),1)],1),s("Col",{attrs:{span:"8"}},[s("Button",{staticClass:"margin-bottom20",attrs:{type:"primary",ghost:""},on:{click:t.clearallSystems}},[t._v("清空选择")]),s("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:t.editallSystems}},[t._v("选择全部")]),s("Button",{staticClass:"margin-bottom20",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",ghost:""},on:{click:t.editSystems}},[t._v("快速选择")])],1)],1),s("Button",{staticClass:"margin-bottom20",attrs:{type:"primary"},on:{click:t.seach}},[t._v("查询")]),s("div",{staticClass:"demo-tabs-style2"},[s("Tabs",{attrs:{type:"card"}},[s("Tab-pane",{attrs:{label:"表格"}},[t.columns.length>0?s("Table",{ref:"table",attrs:{border:"",columns:t.columns,data:t.workList,stripe:""},scopedSlots:t._u([{key:"systemName",fn:function(e){var a=e.row;return[s("strong",[t._v(t._s(a.systemName))])]}}],null,!1,820694384)}):t._e()],1),s("Tab-pane",{attrs:{label:"图表"}},[s("Row",{style:{marginBottom:"10px"},attrs:{gutter:10}},[s("Col",{attrs:{span:"16"}},[s("Card",[s("p",{staticClass:"card-title",attrs:{slot:"title"},slot:"title"},[s("Icon",{attrs:{type:"md-map"}}),t._v("系统工时统计（共计"+t._s(t.total)+"小时）\n              ")],1),s("div",{staticClass:"data-source-row"},[s("div",{staticStyle:{width:"100%",height:"300px"},attrs:{id:"visite_volume_con"}})])])],1),s("Col",{attrs:{span:"8"}},[s("Card",[s("p",{staticClass:"card-title",attrs:{slot:"title"},slot:"title"},[s("Icon",{attrs:{type:"md-map"}}),t._v("系统工时占比分析（共计"+t._s(t.total)+"小时）\n              ")],1),s("div",{staticClass:"data-source-row"},[s("div",{staticStyle:{width:"100%",height:"300px"},attrs:{id:"data_source_con"}})])])],1)],1)],1)],1)],1),s("div",{staticStyle:{"margin-top":"20px"}},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.exportData()}}},[t._v("导出数据")])],1),s("Modal",{staticClass:"systemModal",attrs:{title:"请选择系统","mask-closable":!1,width:500,styles:{top:"30px"}},model:{value:t.systemModalVisible,callback:function(e){t.systemModalVisible=e},expression:"systemModalVisible"}},[s("Tree",{ref:"sysTree",attrs:{"empty-text":"请联系管理员录入系统列表",data:t.systemData,"load-data":t.loadData,"on-check-change":"","show-checkbox":"",multiple:""},on:{"on-toggle-expand":t.expandCheckSys}}),t.treeLoading?s("Spin",{attrs:{size:"large"}}):t._e(),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:t.cancelsystemEdit}},[t._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:t.submitsystemEdit}},[t._v("确定")])],1)],1)],1)},i=[],o=s("365c"),n=s("663f"),r=s("24ce"),l=s.n(r);s("8c92");function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var d={data:function(){var t;return t={total:0,startTime:"",endTime:"",people:[],showdate:[],peopleList:[],system:[],systemList:[],workList:[],systemData:[],systemModalVisible:!1,treeLoading:!1},c(t,"systemData",[]),c(t,"editSystem",[]),c(t,"selectAllFlag",!1),c(t,"visiteVolume",null),c(t,"dataSourcePie",null),c(t,"option",{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},color:["#ff7f50","#87cefa","#da70d6","#32cd32","#6495ed","#ff69b4","#ba55d3","#cd5c5c","#ffa500","#40e0d0","#1e90ff","#ff6347","#7b68ee","#00fa9a","#ffd700","#6699FF","#ff6666","#3cb371","#b8860b","#30e0e0"],grid:{top:"10%",left:"2%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{interval:0},nameTextStyle:{color:"#c3c3c3"}},yAxis:{type:"value"},series:[{name:"工作小时数",type:"bar",data:[]}]}),c(t,"option1",{tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},color:["#ff7f50","#87cefa","#da70d6","#32cd32","#6495ed","#ff69b4","#ba55d3","#cd5c5c","#ffa500","#40e0d0","#1e90ff","#ff6347","#7b68ee","#00fa9a","#ffd700","#6699FF","#ff6666","#3cb371","#b8860b","#30e0e0"],series:[{name:"工时占比",type:"pie",radius:"60%",center:["50%","60%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),t},computed:{columns:function(){if(""!==this.startTime&&""!==this.endTime){var t=[],e=Object(n["a"])(this.startTime,this.endTime);t.push({title:"系统/时间(h)",minWidth:150,fixed:"left",key:"systemName",sortable:!0,slot:"systemName"});for(var s=0;s<e.length;s++)t.push({title:e[s],key:e[s],width:116,sortable:!0,align:"center"});return t}return[]}},methods:{quickTime:function(t){"week"==t?(this.startTime=Object(n["g"])(),this.endTime=Object(n["f"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):"month"==t?(this.startTime=Object(n["e"])(),this.endTime=Object(n["d"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime)):(this.startTime=Object(n["c"])(),this.endTime=Object(n["b"])(),this.showdate=[],this.showdate.push(this.startTime),this.showdate.push(this.endTime))},clearallSystems:function(){this.system=[]},peopleAll:function(){this.people=[];for(var t=0;t<this.peopleList.length;t++){var e=this.peopleList[t];this.people.push(e.userId)}},editallSystems:function(){this.system=[];for(var t=0;t<this.systemList.length;t++){var e=this.systemList[t];this.system.push(e.id)}},editSystems:function(){var t=this;this.treeLoading=!0,Object(o["s"])().then(function(e){t.treeLoading=!1,1===e.code&&(e.data.forEach(function(t){t.checked=!1,t.isParent&&(t.loading=!1,t.children=[]),-1===t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0)}),t.systemData=e.data,t.checkSysTree(t.systemData,t.system),t.systemModalVisible=!0)})},expandCheckSys:function(t){this.checkSysTree(t.children,this.system)},checkSysTree:function(t,e){var s=this;t.forEach(function(t){s.hasSysPerm(t,e)?t.checked=!0:t.checked=!1})},hasSysPerm:function(t,e){for(var s=!1,a=0;a<e.length;a++)if(t.id===e[a]){s=!0;break}return!!s},loadData:function(t,e){Object(o["u"])(t.id,{openDataFilter:!1}).then(function(t){1===t.code&&(t.data.forEach(function(t){t.selected=!1,t.isParent&&(t.loading=!1,t.children=[]),-1===t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0)}),e(t.data))})},cancelsystemEdit:function(){this.systemModalVisible=!1},submitsystemEdit:function(){var t=[],e=this.$refs.sysTree.getCheckedNodes();e.forEach(function(e){t.push(e.id)}),this.system=t,this.systemModalVisible=!1},exportData:function(){this.$refs.table.exportCsv({filename:"工时统计"})},handelChange:function(t){this.startTime=t[0],this.endTime=t[1]},seach:function(){var t={startTime:this.startTime,endTime:this.endTime,people:this.people,system:this.system};this.getTimeList(t)},getTimeList:function(t){var e=this;Object(o["l"])(t).then(function(t){1===t.code&&(e.workList=t.data)}),Object(o["m"])(t).then(function(t){if(1===t.code){e.option.xAxis.data=[],e.option.series[0].data=[],e.option1.series[0].data=[],e.total=0;for(var s=0;s<t.system.length;s++)e.option.xAxis.data.push(t.system[s].title);for(var a=0;a<t.data.length;a++)e.option.series[0].data.push({name:t.data[a]._id.systemName,value:t.data[a].time,itemStyle:{normal:{color:e.option.color[a]}}}),e.option1.series[0].data.push({name:t.data[a]._id.systemName,value:t.data[a].time}),e.total+=t.data[a].time;e.dataSourcePie.setOption(e.option1),e.visiteVolume.setOption(e.option)}})},getUserList:function(){var t=this;Object(o["k"])().then(function(e){1===e.code&&(t.peopleList=e.data)})},getSystemList:function(){var t=this;Object(o["n"])().then(function(e){1===e.code&&(t.systemList=e.data)})}},mounted:function(){var t=this;this.getUserList(),this.getSystemList(),this.$nextTick(function(){t.visiteVolume=l.a.init(document.getElementById("visite_volume_con")),t.dataSourcePie=l.a.init(document.getElementById("data_source_con"))})}},m=d,h=(s("4544"),s("17cc")),p=Object(h["a"])(m,a,i,!1,null,"cfe4aa48",null);e["default"]=p.exports},"366e":function(t,e,s){},4544:function(t,e,s){"use strict";var a=s("366e"),i=s.n(a);i.a}}]);